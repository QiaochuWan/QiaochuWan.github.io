<!DOCTYPE HTML>
<!--
	Based on HTML5 UP template - Qiaochu Wan's Portfolio
	Modified: Added D20 Dice Roller in About Me section
-->
<html>
	<head>
		<title>Qiaochu Wan</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<!-- Load original site assets -->
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>

		<!-- ===== D20 DICE ROLLER STYLES ===== -->
		<style>
			/* ---- Button ---- */
			.dice-roll-btn {
				display: inline-flex;
				align-items: center;
				gap: 10px;
				margin-top: 1.4em;
				padding: 0.7em 1.6em;
				background: linear-gradient(135deg, #1a0533 0%, #3a0a6e 50%, #1a0533 100%);
				border: 2px solid #7c3aed;
				border-radius: 8px;
				color: #e0c3ff;
				font-family: 'Georgia', serif;
				font-size: 1em;
				font-weight: bold;
				letter-spacing: 0.05em;
				cursor: pointer;
				position: relative;
				overflow: hidden;
				transition: all 0.3s ease;
				box-shadow: 0 0 12px rgba(124, 58, 237, 0.5), inset 0 0 8px rgba(124, 58, 237, 0.15);
				text-shadow: 0 0 8px rgba(200, 150, 255, 0.8);
			}
			.dice-roll-btn:hover {
				background: linear-gradient(135deg, #2d0a55 0%, #5b12a8 50%, #2d0a55 100%);
				box-shadow: 0 0 24px rgba(124, 58, 237, 0.9), inset 0 0 12px rgba(124, 58, 237, 0.3);
				transform: translateY(-2px);
				border-color: #a855f7;
			}
			.dice-roll-btn:active { transform: translateY(0); }
			.dice-roll-btn .btn-d20-icon {
				font-size: 1.3em;
				filter: drop-shadow(0 0 4px #a855f7);
			}

			/* ---- Overlay Backdrop ---- */
			#dice-overlay {
				display: none;
				position: fixed;
				inset: 0;
				z-index: 9999;
				background: rgba(5, 0, 18, 0.82);
				backdrop-filter: blur(4px);
				justify-content: center;
				align-items: center;
				flex-direction: column;
				cursor: pointer;
			}
			#dice-overlay.active { display: flex; }

			/* ---- Canvas container ---- */
			#dice-canvas-wrap {
				position: relative;
				width: 260px;
				height: 260px;
			}
			#dice-canvas {
				width: 100%;
				height: 100%;
			}

			/* ---- Result number ---- */
			#dice-result {
				margin-top: 22px;
				font-size: 5.5em;
				font-family: 'Georgia', serif;
				font-weight: bold;
				color: #fff;
				text-shadow: 0 0 20px #c084fc, 0 0 50px #7c3aed, 0 0 80px #4c1d95;
				opacity: 0;
				transform: scale(0.4);
				transition: opacity 0.5s ease, transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
				text-align: center;
				line-height: 1;
			}
			#dice-result.show {
				opacity: 1;
				transform: scale(1);
			}

			/* Critical Hit / Fail labels */
			#dice-result-label {
				margin-top: 4px;
				font-size: 1.1em;
				font-family: 'Georgia', serif;
				letter-spacing: 0.12em;
				color: #e0c3ff;
				opacity: 0;
				transition: opacity 0.5s ease 0.3s;
				text-align: center;
				text-transform: uppercase;
				min-height: 1.4em;
			}
			#dice-result-label.show { opacity: 1; }
			#dice-result-label.crit { color: #fbbf24; text-shadow: 0 0 16px #f59e0b; }
			#dice-result-label.fail { color: #f87171; text-shadow: 0 0 16px #ef4444; }

			/* Dismiss hint */
			#dice-dismiss {
				margin-top: 28px;
				font-size: 0.78em;
				color: rgba(200,180,255,0.5);
				letter-spacing: 0.08em;
				font-family: sans-serif;
				opacity: 0;
				transition: opacity 0.4s ease 1.2s;
			}
			#dice-dismiss.show { opacity: 1; }

			/* Particle sparks */
			.spark {
				position: absolute;
				border-radius: 50%;
				pointer-events: none;
				animation: spark-fly 0.9s ease-out forwards;
			}
			@keyframes spark-fly {
				0%   { transform: translate(0,0) scale(1); opacity: 1; }
				100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
			}

			/* Screen-shake overlay */
			@keyframes shake {
				0%,100% { transform: translate(0,0) rotate(0deg); }
				15%      { transform: translate(-6px,3px) rotate(-1deg); }
				30%      { transform: translate(5px,-4px) rotate(1deg); }
				45%      { transform: translate(-4px,5px) rotate(-0.5deg); }
				60%      { transform: translate(4px,-3px) rotate(0.5deg); }
				75%      { transform: translate(-2px,2px) rotate(-0.3deg); }
			}
			.dice-shake { animation: shake 0.45s ease; }
		</style>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
		<div id="wrapper" class="divided">

			<!-- ===== HERO / INTRO ===== -->
			<section class="banner style1 orient-left content-align-left image-position-right fullscreen onload-image-fade-in onload-content-fade-right">
				<div class="content">
					<h1>Qiaochu Wan</h1>
					<p class="major">
						Ph.D. in Physics<br />
						University of Pittsburgh
					</p>
					<ul class="actions stacked">
						<li><a href="images/CV.pdf" class="button big wide smooth-scroll-middle">Curriculum Vitae</a></li>
						<li><a href="images/qiaochuwan_resume.pdf" class="button big wide smooth-scroll-middle">Resume</a></li>
					</ul>
				</div>
				<div class="image">
					<img src="images/qiaochuwan.webp" alt="Qiaochu Wan" />
				</div>
			</section>

			<!-- ===== ABOUT ME ===== -->
			<section class="spotlight style1 orient-right content-align-left image-position-center onscroll-image-fade-in" id="about">
				<div class="content">
					<h2>About Me</h2>
					<p>
						<strong>Education:</strong> Shanghaitech University, University of California, Berkeley, University of Pittsburgh
					</p>
					<p>
						<strong>Research Interests:</strong> 2D material, excitonic structure, polariton, light-matter interaction
					</p>
					<p>
						<strong>Publications:</strong> <a href="https://scholar.google.com/citations?user=pURY-2IAAAAJ&hl=en">Google Scholar</a>
					</p>

					<!-- ===== D20 BUTTON ===== -->
					<button class="dice-roll-btn" id="roll-btn" aria-label="Roll a D20">
						<span class="btn-d20-icon">â¬¡</span>
						Roll a D20
					</button>
				</div>
				<div class="image">
					<img src="images/TRPG2.jpg" alt="TRPG" />
				</div>
			</section>

			<!-- ===== RESEARCH ===== -->
			<section class="wrapper style1 align-center" id="research">
				<div class="inner">
					<h2>Research</h2>
					<div class="image fit">
						<img src="images/graphene.gif" alt="Graphene" />
					</div>

					<div class="items style1 medium onscroll-fade-in">
						<section>
							<h3>High-efficiency polariton Laser</h3>
							<p>We have placed a van der Waals homostructure, formed by stacking three two-dimensional layers of WSâ‚‚ separated by insulating hBN, inside a microcavity facilitating the formation of exciton-polaritons. We observed laser emission with an ultralow threshold of approximately 59 nW/Î¼mÂ² and a lasing efficiency of 3.82%.</p>
						</section>
						<section>
							<h3>Magneto-optic and electronic characterization of quaternion state in TMD bilayers</h3>
							<p>We present key electrostatic and magnetic measurements confirming the existence of doubly-charged exciton states in strongly screened bilayers of transition metal dichalcogenide layers â€” pointing toward BEC and superconductivity.</p>
						</section>
					</div>
				</div>
			</section>

			<!-- ===== COMMUNITY ===== -->
			<section class="spotlight style1 orient-left content-align-left image-position-center onscroll-image-fade-in" id="community">
				<div class="content">
					<h2>Community</h2>
					<p><strong>Teaching:</strong> Physics Lab 101</p>
					<p><strong>Outreach:</strong> <a href="https://www.snokelab.com">Snoke Lab</a></p>
					<p><strong>Equity &amp; Inclusion:</strong> Our lab is highly diverse with members from various backgrounds.</p>
				</div>
				<div class="image">
					<img src="images/group photo2_JPG.webp" alt="Group Photo" />
				</div>
			</section>

			<!-- ===== CONTACT ===== -->
			<section class="wrapper style1 align-center" id="contact">
				<div class="inner medium">
					<h2>Contact</h2>
					<p>
						<strong>Email:</strong> <a href="mailto:qiw74@pitt.edu">qiw74@pitt.edu</a><br />
						<strong>Address:</strong> Allen Hall G17
					</p>
					<ul class="icons">
						<li><a href="#" class="icon brands style2 fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon brands style2 fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon brands style2 fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="https://github.com/QiaochuWan" class="icon brands style2 fa-github"><span class="label">GitHub</span></a></li>
						<li><a href="mailto:qiw74@pitt.edu" class="icon style2 fa-envelope"><span class="label">Email</span></a></li>
					</ul>
				</div>
			</section>

			<!-- Footer -->
			<footer class="wrapper style1 align-center">
				<div class="inner">
					<p>&copy; Qiaochu Wan. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
				</div>
			</footer>

		</div><!-- /wrapper -->

		<!-- ===== DICE OVERLAY ===== -->
		<div id="dice-overlay" role="dialog" aria-modal="true" aria-label="D20 Dice Roller">
			<div id="dice-canvas-wrap">
				<canvas id="dice-canvas" width="520" height="520"></canvas>
			</div>
			<div id="dice-result" aria-live="polite"></div>
			<div id="dice-result-label"></div>
			<div id="dice-dismiss">Click anywhere to dismiss</div>
		</div>

		<!-- Original site scripts -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/jquery.scrollex.min.js"></script>
		<script src="assets/js/jquery.scrolly.min.js"></script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>

		<!-- ===== D20 DICE ROLLER SCRIPT ===== -->
		<script>
		(function() {
			"use strict";

			/* ---- Config ---- */
			const COLORS = {
				body:    '#2a0654',
				bodyAlt: '#3d0878',
				edge:    '#9333ea',
				edgeAlt: '#c084fc',
				text:    '#f5e6ff',
				glow:    'rgba(167,139,250,',
				sparkColors: ['#c084fc','#a855f7','#7c3aed','#fbbf24','#f9a8d4','#818cf8'],
			};

			/* ---- D20 geometry (icosahedron projected faces) ---- */
			// 20 triangular faces of a d20, each with a number label and 3D normal
			const FACES = [
				{n:1},  {n:2},  {n:3},  {n:4},  {n:5},
				{n:6},  {n:7},  {n:8},  {n:9},  {n:10},
				{n:11}, {n:12}, {n:13}, {n:14}, {n:15},
				{n:16}, {n:17}, {n:18}, {n:19}, {n:20},
			];

			/* ---- Canvas setup ---- */
			const canvas = document.getElementById('dice-canvas');
			const ctx    = canvas.getContext('2d');
			const W = canvas.width;
			const H = canvas.height;
			const CX = W / 2, CY = H / 2;
			const R = 180; // icosahedron radius

			/* ---- Math helpers ---- */
			function rotX(v, a){ return [v[0], v[1]*Math.cos(a)-v[2]*Math.sin(a), v[1]*Math.sin(a)+v[2]*Math.cos(a)]; }
			function rotY(v, a){ return [v[0]*Math.cos(a)+v[2]*Math.sin(a), v[1], -v[0]*Math.sin(a)+v[2]*Math.cos(a)]; }
			function rotZ(v, a){ return [v[0]*Math.cos(a)-v[1]*Math.sin(a), v[0]*Math.sin(a)+v[1]*Math.cos(a), v[2]]; }
			function project(v){ const z = (v[2] + 3.5*R) / (4.5*R); return [CX + v[0]/z, CY - v[1]/z]; }
			function cross(a,b){ return [a[1]*b[2]-a[2]*b[1], a[2]*b[0]-a[0]*b[2], a[0]*b[1]-a[1]*b[0]]; }
			function sub(a,b)  { return [a[0]-b[0], a[1]-b[1], a[2]-b[2]]; }
			function dot(a,b)  { return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]; }
			function normalize(v){ const l=Math.hypot(...v); return v.map(x=>x/l); }

			/* ---- Build icosahedron vertices ---- */
			const phi = (1 + Math.sqrt(5)) / 2;
			const rawVerts = [
				[-1, phi, 0],[ 1, phi, 0],[-1,-phi, 0],[ 1,-phi, 0],
				[ 0,-1, phi],[ 0, 1, phi],[ 0,-1,-phi],[ 0, 1,-phi],
				[ phi, 0,-1],[ phi, 0, 1],[-phi, 0,-1],[-phi, 0, 1]
			].map(v => normalize(v).map(x => x * R));

			/* ---- 20 triangular face definitions ---- */
			const FACE_INDICES = [
				[0,11, 5],[0, 5, 1],[0, 1, 7],[0, 7,10],[0,10,11],
				[1, 5, 9],[5,11, 4],[11,10, 2],[10, 7, 6],[7, 1, 8],
				[3, 9, 4],[3, 4, 2],[3, 2, 6],[3, 6, 8],[3, 8, 9],
				[4, 9, 5],[2, 4,11],[6, 2,10],[8, 6, 7],[9, 8, 1]
			];

			/* ---- State ---- */
			let rolling = false;
			let animId  = null;
			let rx = 0.3, ry = 0.5, rz = 0.1;
			let vx = 0,   vy = 0,   vz = 0;
			let rollResult = null;
			let targetFaceIdx = 0;
			let rollPhase = 'idle'; // idle | spinning | settling | done
			let frameCount = 0;
			let spinDuration = 0;
			let settleFrames = 0;
			let shimmerT = 0;

			/* ---- Drawing ---- */
			function computeFaces(rxA, ryA, rzA) {
				return FACE_INDICES.map((fi, i) => {
					const va = rawVerts[fi[0]], vb = rawVerts[fi[1]], vc = rawVerts[fi[2]];
					const rot = v => rotZ(rotY(rotX(v, rxA), ryA), rzA);
					const ra = rot(va), rb = rot(vb), rc = rot(vc);
					const n = normalize(cross(sub(rb,ra), sub(rc,ra)));
					const brightness = Math.max(0, dot(n, [0.5,0.8,0.6]));
					const pa = project(ra), pb = project(rb), pc = project(rc);
					const cx3d = (ra[0]+rb[0]+rc[0])/3;
					const cy3d = (ra[1]+rb[1]+rc[1])/3;
					const cz3d = (ra[2]+rb[2]+rc[2])/3;
					return {
						verts: [pa,pb,pc],
						faceNum: FACES[i].n,
						brightness,
						facing: n[2] > 0,
						depth: cz3d,
						centerProj: project([cx3d, cy3d, cz3d]),
					};
				}).sort((a,b) => a.depth - b.depth);
			}

			function drawFrame() {
				ctx.clearRect(0, 0, W, H);

				// Outer glow halo
				const grad = ctx.createRadialGradient(CX, CY, R*0.5, CX, CY, R*1.35);
				grad.addColorStop(0, COLORS.glow + '0.18)');
				grad.addColorStop(1, COLORS.glow + '0)');
				ctx.fillStyle = grad;
				ctx.fillRect(0, 0, W, H);

				const faces = computeFaces(rx, ry, rz);
				shimmerT += 0.04;

				faces.forEach(face => {
					const [p0, p1, p2] = face.verts;
					ctx.beginPath();
					ctx.moveTo(p0[0], p0[1]);
					ctx.lineTo(p1[0], p1[1]);
					ctx.lineTo(p2[0], p2[1]);
					ctx.closePath();

					if (!face.facing) {
						// back face â€” dark silhouette
						ctx.fillStyle = '#0d0026';
						ctx.fill();
					} else {
						// Gradient fill
						const gf = ctx.createLinearGradient(p0[0],p0[1],p2[0],p2[1]);
						const b = face.brightness;
						const shimmer = rollPhase === 'done' ? 0.15*Math.sin(shimmerT + face.faceNum) : 0;
						const lit = Math.min(1, b + shimmer);
						const r1 = Math.round(42  + lit*90);
						const g1 = Math.round(6   + lit*30);
						const b1 = Math.round(84  + lit*130);
						const r2 = Math.round(26  + lit*60);
						const g2 = Math.round(3   + lit*18);
						const b2 = Math.round(50  + lit*100);
						gf.addColorStop(0, `rgb(${r1},${g1},${b1})`);
						gf.addColorStop(1, `rgb(${r2},${g2},${b2})`);
						ctx.fillStyle = gf;
						ctx.fill();

						// Edge
						ctx.strokeStyle = lit > 0.5 ? COLORS.edgeAlt : COLORS.edge;
						ctx.lineWidth = 1.5;
						ctx.stroke();

						// Face number â€” only on front-facing faces
						const fc = face.centerProj;
						const avgZ = (faces.find(f => f.faceNum === face.faceNum) || face).depth;
						ctx.save();
						ctx.translate(fc[0], fc[1]);
						const fontSize = Math.round(20 + lit * 8);
						ctx.font = `bold ${fontSize}px Georgia, serif`;
						ctx.textAlign = 'center';
						ctx.textBaseline = 'middle';
						// Number shadow / glow
						if (rollPhase === 'done' && face.faceNum === rollResult) {
							ctx.shadowColor = '#fbbf24';
							ctx.shadowBlur  = 22;
							ctx.fillStyle   = '#fff';
						} else {
							ctx.shadowColor = '#7c3aed';
							ctx.shadowBlur  = 8;
							ctx.fillStyle   = COLORS.text;
						}
						ctx.globalAlpha = Math.min(1, (lit - 0.05) * 3);
						ctx.fillText(face.faceNum, 0, 0);
						ctx.restore();
					}
				});

				// Specular highlight blob
				const hl = ctx.createRadialGradient(CX - R*0.3, CY - R*0.3, 0, CX - R*0.3, CY - R*0.3, R*0.55);
				hl.addColorStop(0, 'rgba(255,255,255,0.12)');
				hl.addColorStop(1, 'rgba(255,255,255,0)');
				ctx.fillStyle = hl;
				ctx.fillRect(0, 0, W, H);
			}

			/* ---- Animation loop ---- */
			function animate() {
				frameCount++;

				if (rollPhase === 'spinning') {
					// Fast chaotic spin
					const t = frameCount / spinDuration;
					const speed = 0.38 * (1 - t * 0.6);
					rx += vx * speed;
					ry += vy * speed;
					rz += vz * speed;

					if (frameCount >= spinDuration) {
						rollPhase = 'settling';
						settleFrames = 0;
					}
				} else if (rollPhase === 'settling') {
					// Ease into upright facing face
					settleFrames++;
					const ease = Math.min(1, settleFrames / 35);
					// Nudge rotation toward target face's "top" orientation gently
					rx *= (1 - ease * 0.06);
					ry *= (1 - ease * 0.04);
					rz *= (1 - ease * 0.04);

					if (settleFrames >= 50) {
						rollPhase = 'done';
						showResult();
					}
				} else if (rollPhase === 'done') {
					// Gentle idle rotation shimmer
					rx += 0.003 * Math.sin(frameCount * 0.04);
					ry += 0.006;
					rz += 0.002 * Math.cos(frameCount * 0.05);
				}

				drawFrame();
				animId = requestAnimationFrame(animate);
			}

			/* ---- Start roll ---- */
			function startRoll() {
				if (rolling) return;
				rolling = true;
				rollResult = null;
				rollPhase  = 'spinning';
				frameCount = 0;
				spinDuration = 80 + Math.floor(Math.random() * 40); // 80-120 frames

				// Random violent angular velocities
				vx = 3.5 + Math.random() * 4;
				vy = 2.5 + Math.random() * 4;
				vz = 1.8 + Math.random() * 3;
				if (Math.random() < 0.5) vx *= -1;
				if (Math.random() < 0.5) vy *= -1;

				// Pick result
				rollResult = Math.floor(Math.random() * 20) + 1;

				// Hide old result
				const resEl    = document.getElementById('dice-result');
				const labelEl  = document.getElementById('dice-result-label');
				const dismissEl= document.getElementById('dice-dismiss');
				resEl.textContent = '';
				resEl.className   = '';
				labelEl.textContent = '';
				labelEl.className   = '';
				dismissEl.className = '';

				// Screen shake
				document.getElementById('dice-canvas-wrap').classList.add('dice-shake');
				setTimeout(() => document.getElementById('dice-canvas-wrap').classList.remove('dice-shake'), 500);

				// Spawn sparks
				spawnSparks();

				if (!animId) { animate(); }
			}

			/* ---- Show result ---- */
			function showResult() {
				const resEl    = document.getElementById('dice-result');
				const labelEl  = document.getElementById('dice-result-label');
				const dismissEl= document.getElementById('dice-dismiss');

				resEl.textContent = rollResult;
				resEl.classList.add('show');

				let label = '';
				let cls   = '';
				if (rollResult === 20) { label = 'âœ¨ Natural 20 â€” Critical Hit!'; cls = 'crit'; spawnSparks(true); }
				else if (rollResult === 1)  { label = 'ðŸ’€ Critical Fail!';               cls = 'fail'; }
				else if (rollResult >= 15)  { label = 'Great Roll!';                     cls = 'crit'; }
				else if (rollResult <= 5)   { label = 'Rough luck...';                   cls = 'fail'; }

				if (label) {
					labelEl.textContent = label;
					labelEl.classList.add('show', cls);
				}

				dismissEl.classList.add('show');
				rolling = false;
			}

			/* ---- Sparks ---- */
			function spawnSparks(burst = false) {
				const wrap  = document.getElementById('dice-canvas-wrap');
				const count = burst ? 28 : 14;
				for (let i = 0; i < count; i++) {
					setTimeout(() => {
						const s    = document.createElement('div');
						s.className = 'spark';
						const size = 5 + Math.random() * 9;
						const angle = Math.random() * Math.PI * 2;
						const dist  = 60 + Math.random() * 120;
						const color = COLORS.sparkColors[Math.floor(Math.random() * COLORS.sparkColors.length)];
						s.style.cssText = `
							width:${size}px;height:${size}px;
							background:${color};
							left:${130 - size/2 + (Math.random()-0.5)*60}px;
							top:${130 - size/2 + (Math.random()-0.5)*60}px;
							--tx:${Math.cos(angle)*dist}px;
							--ty:${Math.sin(angle)*dist}px;
							box-shadow:0 0 6px ${color};
						`;
						wrap.appendChild(s);
						s.addEventListener('animationend', () => s.remove());
					}, i * (burst ? 30 : 50));
				}
			}

			/* ---- Overlay open/close ---- */
			const overlay  = document.getElementById('dice-overlay');
			const rollBtn  = document.getElementById('roll-btn');

			rollBtn.addEventListener('click', () => {
				overlay.classList.add('active');
				// Start rolling immediately
				setTimeout(() => startRoll(), 80);
			});

			overlay.addEventListener('click', () => {
				if (rolling) return; // don't close mid-roll
				overlay.classList.remove('active');
				if (animId) { cancelAnimationFrame(animId); animId = null; }
				rollPhase = 'idle';
			});

			// Prevent click-through from canvas
			canvas.addEventListener('click', e => e.stopPropagation());

			// Keyboard: Escape to close, Space/Enter to roll again
			document.addEventListener('keydown', e => {
				if (!overlay.classList.contains('active')) return;
				if (e.key === 'Escape') { overlay.click(); }
				if ((e.key === ' ' || e.key === 'Enter') && !rolling) { startRoll(); }
			});
		})();
		</script>
	</body>
</html>
